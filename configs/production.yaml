# MangaHub Production Configuration (Railway + Neon)
# Environment variables OVERRIDE these defaults via bindEnvVars()
# Set in Railway Dashboard: DB_HOST, DB_USER, DB_PASSWORD, DB_NAME, DB_SSLMODE, JWT_SECRET

server:
  host: "0.0.0.0"           # Railway binds to 0.0.0.0
  port: 8080                # Overridden by Railway's PORT env var
  read_timeout: "30s"
  write_timeout: "30s"
  idle_timeout: "120s"
  mode: "release"           # Overridden by GIN_MODE env var

# PostgreSQL Database Configuration (Neon)
# ALL of these are overridden by Railway env vars: DB_HOST, DB_USER, DB_PASSWORD, DB_NAME, DB_SSLMODE
database:
  host: "localhost"         # Overridden by DB_HOST
  port: 5432                # Overridden by DB_PORT
  user: "postgres"          # Overridden by DB_USER
  password: ""              # Overridden by DB_PASSWORD
  database: "postgres"      # Overridden by DB_NAME
  ssl_mode: "require"       # Overridden by DB_SSLMODE (always require for Neon)
  max_open_conns: 25
  max_idle_conns: 5
  conn_max_lifetime: "5m"
  conn_max_idle_time: "2m"
  timeout: "10s"

jwt:
  secret: "CHANGE_ME_IN_RAILWAY_ENV"  # Overridden by JWT_SECRET env var
  expiration: "24h"
  issuer: "mangahub"

# TCP Stats Service (disabled on Railway)
tcp:
  host: "0.0.0.0"
  port: 6000
  max_connections: 100
  buffer_size: 4096

# UDP Notification Service (disabled on Railway)
udp:
  host: "0.0.0.0"
  port: 4000
  buffer_size: 1024

# gRPC Search Service (runs on separate port - may not work on Railway free tier)
grpc:
  host: "0.0.0.0"
  port: 50051               # Overridden by GRPC_PORT (Railway only exposes 1 port)

# WebSocket Chat Service (runs on same HTTP port - works on Railway!)
websocket:
  host: "0.0.0.0"
  port: 8080                # Uses same port as HTTP (Railway's PORT)
  read_buffer_size: 1024
  write_buffer_size: 1024
  handshake_timeout: "10s"
  ping_period: "54s"
  max_message_size: 8192

logging:
  level: "info"             # Overridden by LOG_LEVEL
  format: "json"
  output: "stdout"

# External APIs (No API keys required)
mangadex:
  base_url: "https://api.mangadex.org"
  rate_limit: 5
  timeout: "30s"
  retry_attempts: 3

jikan:
  base_url: "https://api.jikan.moe/v4"
  rate_limit: 3
  timeout: "30s"
  retry_attempts: 3

anilist:
  base_url: "https://graphql.anilist.co"
  rate_limit: 30
  timeout: "30s"
  retry_attempts: 3
